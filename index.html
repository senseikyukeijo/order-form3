<!DOCTYPE html>
<html lang="ja">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<title>先生向けミニショップ（LIFF）</title>
<meta name="color-scheme" content="light dark" />
<script src="https://static.line-scdn.net/liff/edge/2/sdk.js"></script>
<style>
body{font-family:system-ui, sans-serif;margin:0;padding:0;background:#f5f5f5;color:#333}
.wrap{max-width:900px;margin:0 auto;padding:20px}
.grid{display:grid;grid-template-columns:repeat(auto-fit,minmax(260px,1fr));gap:14px}
.card{background:#fff;border:1px solid #ddd;border-radius:12px;padding:14px;box-shadow:0 2px 4px rgba(0,0,0,0.08)}
.card .img{width:64px;height:64px;border-radius:10px;display:grid;place-items:center;font-size:32px;background:#f0f0f0;margin-bottom:8px}
.title{font-weight:700;margin:0 0 6px 0}
.price{font-weight:700;color:#0070f3}
.row{display:flex;align-items:center;gap:10px;flex-wrap:wrap}
.btn{background:#0070f3;color:#fff;border:none;border-radius:8px;padding:8px 12px;font-weight:600;cursor:pointer}
.side{background:#fff;border:1px solid #ddd;border-radius:12px;padding:16px;margin-top:20px}
.line{display:flex;gap:10px;align-items:center;margin-bottom:10px}
.qty{display:flex;align-items:center;border:1px solid #ccc;border-radius:6px}
.qty button{background:transparent;border:none;padding:4px 8px;cursor:pointer}
.qty input{width:40px;border:none;text-align:center}
.total{font-size:18px;font-weight:800}
</style>
</head>
<body>
<div class="wrap">
<h1>先生ミニショップ</h1>
<div class="grid" id="catalog"></div>


<aside class="side">
<h2>カート</h2>
<div id="cartList"></div>
<div class="row"><span>小計:</span><span id="subtotal">¥0</span></div>
<div class="row"><span>税込:</span><span id="tax">¥0</span></div>
<div class="row total"><span>合計:</span><span id="total">¥0</span></div>
<button class="btn" id="checkout">注文する</button>
</aside>
</div>


<script>
const LIFF_ID = "YOUR_LIFF_ID_HERE";
const ORDER_WEBHOOK_URL = "https://example.com/your-webhook";
const TAX_RATE = 0.10;


const PRODUCTS = [
{id:"P01", name:"赤ペン 0.5mm（3本）", price:300, unit:"セット", emoji:"🖊️"},
{id:"P02", name:"黒ボールペン 1.0mm（3本）", price:280, unit:"セット", emoji:"✒️"},
{id:"P03", name:"青ボールペン 0.7mm（2本）", price:200, unit:"セット", emoji:"🖋️"},
{id:"P04", name:"ドリップコーヒー（5パック）", price:420, unit:"箱", emoji:"☕"},
{id:"P05", name:"ミネラルウォーター（500ml）", price:120, unit:"本", emoji:"💧"}
];


const $ = (s)=>document.querySelector(s);
const state = { cart: {} };


function save(){ renderCart(); }
function money(n){ return "¥"+n.toLocaleString("ja-JP"); }
function addToCart(id){ state.cart[id] = (state.cart[id]||0)+1; save(); }
function setQty(id,q){ const n=Math.max(0,parseInt(q||0)); if(n===0) delete state.cart[id]; else state.cart[id]=n; save(); }
function cartItems(){ return Object.entries(state.cart).map(([id,qty])=>{ const p=PRODUCTS.find(x=>x.id===id); return {...p, qty}; }); }
function totals(){ const sub=cartItems().reduce((a,b)=>a+b.price*b.qty,0); const tax=Math.round(sub*TAX_RATE); return {sub,tax,total:sub+tax}; }


function renderCatalog(){
$('#catalog').innerHTML = PRODUCTS.map(p=>`
<div class="card">
<div class="img">${p.emoji}</div>
<p class="title">${p.name}</p>
<p class="price">${money(p.price)}</p>
<button class="btn" onclick="addToCart('${p.id}')">カートに追加</button>
</div>`).join('');
}


function renderCart(){
const list=cartItems();
const area=$('#cartList');
if(list.length===0){ area.innerHTML='<p>カートは空です</p>'; }
else {
area.innerHTML=list.map(i=>`
<div class="line">
<div class="img" style="width:32px;height:32px">${i.emoji}</div>
