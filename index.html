<!DOCTYPE html>
<html lang="ja">
<head>
  <meta charset="UTF-8">
  <title>先生ミニショップ</title>
  <style>
    body { font-family: Arial, sans-serif; margin: 20px; }
    .product { border: 1px solid #ccc; padding: 10px; margin: 10px; border-radius: 8px; width: 200px; text-align: center; display: inline-block; vertical-align: top; }
    .hidden { display: none; }
    input[type='number'] { width: 60px; }
    img { width: 80px; height: 80px; display: block; margin: auto; }
  </style>
</head>
<body>
  <h1>先生ミニショップ</h1>

  <!-- 商品選択画面 -->
  <div id="catalogScreen">
    <h2>商品一覧</h2>
    <div id="productList"></div>
    <button onclick="showCart()">カートを見る</button>
  </div>

  <!-- 注文確認画面 -->
  <div id="cartScreen" class="hidden">
    <h2>注文確認</h2>
    <div id="cart"></div>
    <p id="total"></p>
    <button onclick="submitOrder()">注文する</button>
    <button onclick="showCatalog()">商品に戻る</button>
  </div>

  <script>
    const products = [
      { name: '赤ペン', price: 300, icon: '🖊️' },
      { name: '黒ボールペン', price: 280, icon: '✒️' },
      { name: '青ボールペン', price: 280, icon: '🖋️' },
      { name: 'コーヒー', price: 150, icon: '☕' },
      { name: '水', price: 100, icon: '💧' }
    ];

    let cart = [];

    function renderProducts() {
      const list = document.getElementById('productList');
      list.innerHTML = '';
      products.forEach((p, idx) => {
        list.innerHTML += `
          <div class="product">
            <div style="font-size:40px;">${p.icon}</div>
            <strong>${p.name}</strong><br>
            ${p.price}円<br>
            数量: <input type="number" id="qty${idx}" min="1" value="1"><br>
            <button onclick="addToCart('${p.name}', ${p.price}, document.getElementById('qty${idx}').value)">カートに追加</button>
          </div>`;
      });
    }

    function addToCart(name, price, qty) {
      qty = parseInt(qty);
      if (isNaN(qty) || qty <= 0) return;
      let item = cart.find(p => p.name === name);
      if (item) {
        item.qty += qty;
      } else {
        cart.push({name, price, qty});
      }
      alert(name + 'を' + qty + '個カートに追加しました');
    }

    function showCart() {
      document.getElementById('catalogScreen').classList.add('hidden');
      document.getElementById('cartScreen').classList.remove('hidden');
      renderCart();
    }

    function showCatalog() {
      document.getElementById('cartScreen').classList.add('hidden');
      document.getElementById('catalogScreen').classList.remove('hidden');
    }

    function renderCart() {
      let cartDiv = document.getElementById('cart');
      cartDiv.innerHTML = '';
      let total = 0;
      cart.forEach((item, index) => {
        let subtotal = item.price * item.qty;
        total += subtotal;
        cartDiv.innerHTML += `
          <div>
            ${item.name} - ${item.price}円 
            数量: <input type="number" min="0" value="${item.qty}" onchange="updateQty(${index}, this.value)"> 
            小計: ${subtotal}円
          </div>`;
      });
      document.getElementById('total').innerText = '合計: ' + total + '円';
    }

    function updateQty(index, newQty) {
      newQty = parseInt(newQty);
      if (isNaN(newQty) || newQty < 0) return;
      if (newQty === 0) {
        cart.splice(index, 1);
      } else {
        cart[index].qty = newQty;
      }
      renderCart();
    }

    function submitOrder() {
      if (cart.length === 0) {
        alert('カートが空です');
        return;
      }
      let orderText = '注文内容:\n';
      cart.forEach(item => {
        orderText += `${item.name} x ${item.qty}\n`;
      });
      alert(orderText + '\n注文を送信しました！');
      cart = [];
      showCatalog();
    }

    renderProducts();
  </script>
</body>
</html>
